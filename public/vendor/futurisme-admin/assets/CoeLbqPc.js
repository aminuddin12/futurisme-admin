import{X as e,r,G as a,j as s,S as t,I as l,R as i,a as d,A as o}from"./BeCmri_R.js";import{A as n}from"./C5oCxwZT.js";import{P as c,I as m,T as g,a as u}from"./Cs2bQ_4v.js";import{M as x}from"./CJuA7lg8.js";import"./BvnFikG3.js";import"./Ptq5osBr.js";import"./hvmUDNpq.js";import"./w3Dlj-22.js";import"./BLP4e3of.js";function p({grouped_menus:p,parents:h,permissions:b,existing_groups:y}){var v;const{config:j}=e().props,f=null==(v=null==j?void 0:j.theme)?void 0:v.color_primary,N="default"!==f&&f?f:"#4f46e5",[k,w]=r.useState(p),[_,C]=r.useState(!1),[S,M]=r.useState(!1),[I,A]=r.useState(null),[R,P]=r.useState(""),[G,D]=r.useState([]),{data:O,setData:T,post:U,put:E,delete:L,processing:$,errors:q,reset:z}=a({title:"",url:"",route:"",icon:"",parent_id:"",permission_name:"",is_active:3,group:"general",by_module:"aminuddin12/futurisme-admin",order:0});r.useEffect(()=>{w(p)},[p]);const F=(e=null,r="general",a="")=>{A(e),e?T({title:e.title,url:e.url||"",route:e.route||"",icon:e.icon||"",parent_id:e.parent_id?String(e.parent_id):"",permission_name:e.permission_name||"",is_active:e.is_active,group:e.group,by_module:e.by_module,order:e.order}):(z(),T(e=>({...e,group:r,by_module:a||e.by_module,is_active:3}))),C(!0)},W=e=>{confirm("Are you sure you want to delete this menu?")&&L(route("futurisme.sidebar.destroy",e))},B=({items:e,depth:r=1})=>s.jsx("div",{className:"flex flex-col w-full",children:e.map(e=>s.jsxs("div",{className:"relative w-full",children:[s.jsxs("div",{className:`\n                                flex items-center justify-between p-3 my-1 rounded-lg border border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm\n                                ${e.is_active?"":"opacity-50 grayscale"}\n                            `,style:{marginLeft:24*r+"px"},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-1.5 bg-gray-50 dark:bg-gray-700 rounded text-gray-500",children:s.jsx(l,{icon:e.icon||"lucide:circle",className:"w-4 h-4"})}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-sm text-gray-700 dark:text-gray-200",children:e.title}),s.jsxs("div",{className:"flex gap-2 text-[10px] text-gray-400",children:[e.route&&s.jsxs("span",{children:["route: ",e.route]}),s.jsxs("span",{className:e.is_active%2!=0?"text-green-500":"text-red-500",children:["status: ",e.is_active]})]})]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>F(e),className:"p-1.5 hover:bg-blue-50 text-blue-600 rounded transition-colors",children:s.jsx(l,{icon:"lucide:edit-2",className:"w-4 h-4"})}),![0,1].includes(e.is_active)&&s.jsx("button",{onClick:()=>W(e.id),className:"p-1.5 hover:bg-red-50 text-red-600 rounded transition-colors",children:s.jsx(l,{icon:"lucide:trash-2",className:"w-4 h-4"})})]})]}),e.children&&e.children.length>0&&s.jsx(B,{items:e.children,depth:r+1})]},e.id))});return s.jsxs(n,{children:[s.jsx(t,{title:"Sidebar Management"}),s.jsxs("div",{className:"py-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Sidebar Manager"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Customize layout, groups, and visibility of menu items."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors shadow-sm",children:[s.jsx(l,{icon:"lucide:folder-plus",className:"w-4 h-4"}),"New Group"]}),s.jsxs("button",{onClick:()=>{const e=k.flatMap(e=>e.groups.flatMap((e,r)=>e.items.map((r,a)=>({id:r.id,order:a,group:e.group_name}))));o.post(route("futurisme.sidebar.reorder"),{items:e},{preserveScroll:!0})},className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors shadow-sm",children:[s.jsx(l,{icon:"lucide:save",className:"w-4 h-4"}),"Save Order"]}),s.jsxs(c,{onClick:()=>F(),style:{backgroundColor:N},className:"flex items-center gap-2",children:[s.jsx(l,{icon:"lucide:plus",className:"w-4 h-4"}),"Add Menu"]})]})]}),s.jsx("div",{className:"space-y-8",children:k.map((e,r)=>s.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden bg-gray-50/50 dark:bg-gray-900/50 shadow-sm",children:[s.jsxs("div",{className:"bg-gray-200 dark:bg-gray-800 px-4 py-3 border-b border-gray-300 dark:border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(l,{icon:"lucide:package",className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),s.jsx("h2",{className:"font-bold text-gray-800 dark:text-gray-200 font-mono text-sm",children:e.module_name})]}),s.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-gray-300 dark:bg-gray-700 rounded-full text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Module"})]}),s.jsx("div",{className:"p-4 space-y-6",children:e.groups.map((a,t)=>s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("span",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap pl-2",children:a.group_name}),s.jsx("div",{className:"h-px bg-gray-300 dark:bg-gray-600 flex-1 opacity-70"}),s.jsxs("button",{onClick:()=>F(null,a.group_name,e.module_name),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1 opacity-70 hover:opacity-100 transition-opacity",children:[s.jsx(l,{icon:"lucide:plus",className:"w-3 h-3"})," Add Item"]})]}),s.jsx(i,{axis:"y",values:a.items,onReorder:e=>((e,r,a)=>{const s=[...k];s[e].groups[r].items=a,w(s)})(r,t,e),className:"space-y-1 min-h-[10px]",children:a.items.map(r=>s.jsxs(d,{value:r,id:String(r.id),children:[s.jsxs("div",{className:`\n                                                        relative group flex items-center justify-between p-3 bg-white dark:bg-gray-800 \n                                                        border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm hover:shadow-md \n                                                        transition-all cursor-grab active:cursor-grabbing ml-0 md:ml-4\n                                                        ${0===r.is_active||2===r.is_active?"border-l-4 border-l-red-400 opacity-75":"border-l-4 border-l-green-400"}\n                                                    `,children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[s.jsx(l,{icon:"lucide:grip-vertical",className:"text-gray-300"}),s.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:s.jsx(l,{icon:r.icon||"lucide:circle",className:"w-5 h-5"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200 text-sm",children:r.title}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[r.route?s.jsx("code",{className:"bg-gray-100 dark:bg-gray-900 px-1 py-0.5 rounded",children:r.route}):s.jsx("span",{children:"-"}),r.permission_name&&s.jsxs("span",{className:"flex items-center gap-0.5 text-orange-500 bg-orange-50 dark:bg-orange-900/20 px-1 py-0.5 rounded",children:[s.jsx(l,{icon:"lucide:lock",className:"w-3 h-3"}),r.permission_name]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>F(r,a.group_name,e.module_name),className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",title:"Edit",children:s.jsx(l,{icon:"lucide:edit",className:"w-4 h-4"})}),![0,1].includes(r.is_active)&&s.jsx("button",{onClick:()=>W(r.id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Delete",children:s.jsx(l,{icon:"lucide:trash",className:"w-4 h-4"})})]})]}),r.children&&r.children.length>0&&s.jsx("div",{className:"mt-2 mb-3 ml-4 md:ml-8 border-l-2 border-gray-200 dark:border-gray-700 pl-4",children:s.jsx(B,{items:r.children})})]},r.id))}),0===a.items.length&&s.jsx("div",{className:"ml-4 py-3 text-center border border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-gray-400 text-sm",children:"No items in this group"})]},a.group_name))})]},e.module_name))}),s.jsx(x,{isOpen:_,onClose:()=>C(!1),title:I?"Edit Menu Item":"New Menu Item",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),I?E(route("futurisme.sidebar.update",I.id),{onSuccess:()=>C(!1)}):U(route("futurisme.sidebar.store"),{onSuccess:()=>{C(!1),D(G.filter(e=>e!==O.group))}})},children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Title"}),s.jsx(g,{value:O.title,onChange:e=>T("title",e.target.value),className:"w-full mt-1",placeholder:"Menu Title"}),s.jsx(u,{message:q.title})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Icon (Iconify)"}),s.jsxs("div",{className:"relative",children:[s.jsx(g,{value:O.icon,onChange:e=>T("icon",e.target.value),className:"w-full mt-1 pl-10",placeholder:"lucide:home"}),s.jsx("div",{className:"absolute top-1/2 left-3 transform -translate-y-1/2 pt-1 text-gray-400",children:s.jsx(l,{icon:O.icon||"lucide:search",className:"w-5 h-5"})})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Route (e.g. admin.dashboard)"}),s.jsx(g,{value:O.route,onChange:e=>T("route",e.target.value),className:"w-full mt-1",placeholder:"Route Name"})]}),s.jsxs("div",{children:[s.jsx(m,{value:"URL (Optional)"}),s.jsx(g,{value:O.url,onChange:e=>T("url",e.target.value),className:"w-full mt-1",placeholder:"/path/to/url"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Group"}),s.jsxs("select",{value:O.group,onChange:e=>T("group",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[y.map(e=>s.jsx("option",{value:e,children:e},e)),G.map(e=>s.jsxs("option",{value:e,children:[e," (New)"]},e))]})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Parent Menu"}),s.jsxs("select",{value:O.parent_id,onChange:e=>T("parent_id",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[s.jsx("option",{value:"",children:"No Parent (Root)"}),h.filter(e=>e.id!==(null==I?void 0:I.id)).map(e=>s.jsx("option",{value:e.id,children:e.title},e.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Permission Required"}),s.jsxs("select",{value:O.permission_name,onChange:e=>T("permission_name",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[s.jsx("option",{value:"",children:"No Permission"}),b.map(e=>s.jsx("option",{value:e.name,children:e.name},e.name))]})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Active Status"}),s.jsx("select",{value:O.is_active,onChange:e=>T("is_active",parseInt(e.target.value)),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:(!I||0!==I.is_active&&1!==I.is_active?[{value:2,label:"2 - Inactive (User)"},{value:3,label:"3 - Active (User)"}]:[{value:0,label:"0 - Inactive (System)"},{value:1,label:"1 - Active (System)"}]).map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))}),s.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"0/1: System Protected. 2/3: Deletable."})]})]}),s.jsxs("div",{className:"flex justify-end mt-6 gap-3",children:[s.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),s.jsx(c,{disabled:$,style:{backgroundColor:N},children:I?"Update Menu":"Create Menu"})]})]})}),s.jsx(x,{isOpen:S,onClose:()=>M(!1),title:"Create New Group",maxWidth:"max-w-sm",children:s.jsxs("div",{children:[s.jsx(m,{value:"Group Name"}),s.jsx(g,{value:R,onChange:e=>P(e.target.value),className:"w-full mt-1",placeholder:"e.g. Analytics",autoFocus:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This group will be created locally. It will be saved to database once you add a menu item to it."}),s.jsxs("div",{className:"flex justify-end mt-6 gap-3",children:[s.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),s.jsx(c,{onClick:()=>{R.trim()&&(D([...G,R]),M(!1),P(""),z(),T(e=>({...e,group:R})),C(!0))},style:{backgroundColor:N},children:"Create Group"})]})]})})]})]})}export{p as default};
