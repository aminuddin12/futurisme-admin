import{r as o,j as R}from"./app-DxU9LLl0.js";import{M as b,i as A,u as k,P as D,a as H,b as K,L as B}from"./proxy-ClRG6IiI.js";function z(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function F(...e){return s=>{let t=!1;const r=e.map(i=>{const n=z(i,s);return!t&&typeof n=="function"&&(t=!0),n});if(t)return()=>{for(let i=0;i<r.length;i++){const n=r[i];typeof n=="function"?n():z(e[i],null)}}}}function G(...e){return o.useCallback(F(...e),e)}class T extends o.Component{getSnapshotBeforeUpdate(s){const t=this.props.childRef.current;if(t&&s.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=A(r)&&r.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=i-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function U({children:e,isPresent:s,anchorX:t,root:r}){const i=o.useId(),n=o.useRef(null),h=o.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:y}=o.useContext(b),w=G(n,e==null?void 0:e.ref);return o.useInsertionEffect(()=>{const{width:u,height:m,top:f,left:a,right:p}=h.current;if(s||!n.current||!u||!m)return;const C=t==="left"?`left: ${a}`:`right: ${p}`;n.current.dataset.motionPopId=i;const l=document.createElement("style");y&&(l.nonce=y);const E=r??document.head;return E.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${m}px !important;
            ${C}px !important;
            top: ${f}px !important;
          }
        `),()=>{E.contains(l)&&E.removeChild(l)}},[s]),R.jsx(T,{isPresent:s,childRef:n,sizeRef:h,children:o.cloneElement(e,{ref:w})})}const V=({children:e,initial:s,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:n,mode:h,anchorX:y,root:w})=>{const u=k(X),m=o.useId();let f=!0,a=o.useMemo(()=>(f=!1,{id:m,initial:s,isPresent:t,custom:i,onExitComplete:p=>{u.set(p,!0);for(const C of u.values())if(!C)return;r&&r()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[t,u,r]);return n&&f&&(a={...a}),o.useMemo(()=>{u.forEach((p,C)=>u.set(C,!1))},[t]),o.useEffect(()=>{!t&&!u.size&&r&&r()},[t]),h==="popLayout"&&(e=R.jsx(U,{isPresent:t,anchorX:y,root:w,children:e})),R.jsx(D.Provider,{value:a,children:e})};function X(){return new Map}const P=e=>e.key||"";function I(e){const s=[];return o.Children.forEach(e,t=>{o.isValidElement(t)&&s.push(t)}),s}const J=({children:e,custom:s,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:n="sync",propagate:h=!1,anchorX:y="left",root:w})=>{const[u,m]=H(h),f=o.useMemo(()=>I(e),[e]),a=h&&!u?[]:f.map(P),p=o.useRef(!0),C=o.useRef(f),l=k(()=>new Map),[E,S]=o.useState(f),[x,L]=o.useState(f);K(()=>{p.current=!1,C.current=f;for(let d=0;d<x.length;d++){const c=P(x[d]);a.includes(c)?l.delete(c):l.get(c)!==!0&&l.set(c,!1)}},[x,a.length,a.join("-")]);const M=[];if(f!==E){let d=[...f];for(let c=0;c<x.length;c++){const g=x[c],$=P(g);a.includes($)||(d.splice(c,0,g),M.push(g))}return n==="wait"&&M.length&&(d=M),L(I(d)),S(f),null}const{forceRender:j}=o.useContext(B);return R.jsx(R.Fragment,{children:x.map(d=>{const c=P(d),g=h&&!u?!1:f===x||a.includes(c),$=()=>{if(l.has(c))l.set(c,!0);else return;let v=!0;l.forEach(W=>{W||(v=!1)}),v&&(j==null||j(),L(C.current),h&&(m==null||m()),r&&r())};return R.jsx(V,{isPresent:g,initial:!p.current||t?void 0:!1,custom:s,presenceAffectsLayout:i,mode:n,root:w,onExitComplete:g?void 0:$,anchorX:y,children:d},c)})})},N=(e,s)=>{try{if(typeof window.route!="function")return s;const t=window.route();if(t&&typeof t.has=="function"&&t.has(e))return window.route(e)}catch{}return s};export{J as A,N as s};
