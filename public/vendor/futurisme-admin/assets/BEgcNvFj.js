import{X as e,r,G as a,j as s,S as t,I as i,A as d,m as l,R as o,a as n,b as c}from"./BiG0yOxZ.js";import{A as g}from"./DvEbVfW3.js";import{I as m,T as u,a as x,P as p}from"./VQBJNlAA.js";import{M as h}from"./Cn8GMEbk.js";import"./BvnFikG3.js";import"./BBgQnKOS.js";import"./C7J0pgGl.js";import"./B_RUI1DI.js";import"./BllKJuBp.js";const b=()=>s.jsx("div",{className:"w-full space-y-4 p-4",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-1/4 space-y-3",children:[1,2,3].map(e=>s.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},e))}),s.jsxs("div",{className:"w-3/4 space-y-6",children:[s.jsx("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"}),s.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(e=>s.jsx("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},e))})]})]})}),y=({moduleData:e,onAddGroup:a,onAddItem:t,onEditItem:g,onDelete:m,primaryColor:u})=>{const x=r=>{const a=r.reduce((e,r)=>{const a=r.group||"general";return e[a]||(e[a]=[]),e[a].push(r),e},{});let s=[];return Object.keys(a).sort((e,r)=>"general"===e?-1:1).forEach(r=>{s.push({id:`divider-${r}-${e.module_name}`,type:"divider",group_name:r,title:r,is_active:1,order:-1,group:r,by_module:e.module_name});const t=(e,r=null,a=0)=>{e.filter(e=>e.parent_id===r).sort((e,r)=>e.order-r.order).forEach(r=>{s.push({...r,depth:a}),t(e,Number(r.id),a+1)})};t(a[r])}),s},[p,h]=r.useState(x(e.items)),[b,y]=r.useState(!1);r.useEffect(()=>{h(x(e.items)),y(!1)},[e]);const v=(e,r)=>{const a=[...p],s=a[e],t=a[e-1];if("divider"!==s.type&&t&&"divider"!==t.type){if(r>0)(s.depth||0)<=(t.depth||0)&&(s.depth=(s.depth||0)+1,s.parent_id=Number(t.id));else if((s.depth||0)>0)if(s.depth=(s.depth||0)-1,0===s.depth)s.parent_id=null;else for(let r=e-1;r>=0;r--)if((a[r].depth||0)===s.depth-1){s.parent_id=Number(a[r].id);break}h(a),y(!0)}};return s.jsxs("div",{id:`module-${e.module_name}`,className:"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden bg-white dark:bg-gray-800 shadow-sm mb-8 scroll-mt-24",children:[s.jsxs("div",{className:"sticky top-0 z-20 bg-gray-50 dark:bg-gray-800 px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between backdrop-blur-md bg-opacity-90 dark:bg-opacity-90",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 shadow-sm",children:s.jsx(i,{icon:"lucide:package",className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold text-gray-800 dark:text-gray-200 text-sm tracking-tight",children:e.module_name}),s.jsx("span",{className:"text-[10px] font-medium text-gray-500 uppercase tracking-wider",children:"Module Config"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:a,className:"p-2 text-xs font-medium bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors flex items-center gap-1 shadow-sm",title:"Add Group",children:s.jsx(i,{icon:"lucide:folder-plus",className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>t("general",e.module_name),className:"p-2 text-xs font-medium bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors flex items-center gap-1 shadow-sm",title:"Add Menu",children:s.jsx(i,{icon:"lucide:plus",className:"w-4 h-4"})}),s.jsx(d,{children:b&&s.jsxs(l.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:()=>{c.post(route("futurisme.sidebar.reorder"),{items:p.map(e=>({id:"divider"===e.type?null:e.id,type:e.type,group_name:e.group_name,parent_id:e.parent_id})),module_name:e.module_name},{preserveScroll:!0,onSuccess:()=>y(!1)})},style:{backgroundColor:u},className:"flex items-center gap-1 px-4 py-2 text-white text-xs font-bold rounded-lg shadow-md hover:opacity-90 transition-all",children:[s.jsx(i,{icon:"lucide:save",className:"w-3 h-3"})," Save Changes"]})})]})]}),s.jsx("div",{className:"p-4 bg-gray-50/30 dark:bg-gray-900/30 min-h-[100px]",children:s.jsx(o,{axis:"y",values:p,onReorder:e=>{h(e),y(!0)},className:"space-y-1",children:p.map((r,a)=>s.jsx(n,{value:r,id:String(r.id),dragListener:"divider"!==r.type,children:"divider"===r.type?s.jsxs("div",{className:"mt-6 mb-3 flex items-center gap-4 select-none group",children:[s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full border border-gray-200 dark:border-gray-700",children:[s.jsx(i,{icon:"lucide:layers",className:"w-3 h-3 text-gray-500"}),s.jsx("span",{className:"text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:r.title})]}),s.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700 flex-1"}),s.jsxs("button",{onClick:()=>t(r.group_name,e.module_name),className:"text-[10px] opacity-0 group-hover:opacity-100 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 px-3 py-1 rounded-full text-gray-500 hover:text-indigo-600 hover:border-indigo-300 transition-all shadow-sm",children:["+ Add to ",r.group_name]})]}):s.jsxs("div",{className:`\n                                        relative group flex items-center p-3 \n                                        bg-white dark:bg-gray-800 \n                                        border border-gray-200 dark:border-gray-700 \n                                        rounded-lg shadow-sm \n                                        transition-all duration-200 ease-in-out\n                                        ${0===r.is_active||2===r.is_active?"opacity-60 grayscale-[0.5]":""}\n                                        hover:border-indigo-300 dark:hover:border-indigo-700 hover:shadow-md\n                                    `,style:{marginLeft:28*(r.depth||0)+"px",width:`calc(100% - ${28*(r.depth||0)}px)`},children:[(r.depth||0)>0&&s.jsx("div",{className:"absolute -left-4 top-1/2 w-4 h-px bg-gray-300 dark:bg-gray-600"}),(r.depth||0)>0&&s.jsx("div",{className:"absolute -left-4 top-0 bottom-1/2 w-px bg-gray-300 dark:bg-gray-600 -mt-5"}),s.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[s.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-300 hover:text-gray-500 transition-colors",children:s.jsx(i,{icon:"lucide:grip-vertical",className:"w-4 h-4"})}),s.jsx("div",{className:`\n                                            shrink-0 w-8 h-8 rounded-lg flex items-center justify-center \n                                            ${0===r.is_active||2===r.is_active?"bg-red-50 text-red-500":"bg-indigo-50 text-indigo-500"}\n                                            dark:bg-gray-700 dark:text-gray-300\n                                        `,children:s.jsx(i,{icon:r.icon||"lucide:circle",className:"w-4 h-4"})}),s.jsxs("div",{className:"flex flex-col min-w-0",children:[s.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200 text-sm truncate",children:r.title}),s.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[r.route?s.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-900 px-1.5 py-0.5 rounded truncate max-w-[150px]",children:r.route}):s.jsx("span",{children:"-"}),r.permission_name&&s.jsxs("span",{className:"flex items-center gap-0.5 text-amber-600 dark:text-amber-500",children:[s.jsx(i,{icon:"lucide:lock",className:"w-3 h-3"}),r.permission_name]}),s.jsxs("span",{className:"px-1.5 py-0.5 rounded-full "+([1,3,4].includes(r.is_active)?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:["S:",r.is_active]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity pl-2",children:[s.jsx("button",{onClick:()=>v(a,-1),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 rounded-md transition-colors",title:"Outdent",children:s.jsx(i,{icon:"lucide:chevron-left",className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>v(a,1),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 rounded-md transition-colors",title:"Indent",children:s.jsx(i,{icon:"lucide:chevron-right",className:"w-4 h-4"})}),s.jsx("div",{className:"w-px h-4 bg-gray-200 dark:bg-gray-700 mx-1"}),s.jsx("button",{onClick:()=>g(r),className:"p-1.5 hover:bg-indigo-50 text-indigo-600 rounded-md transition-colors",children:s.jsx(i,{icon:"lucide:edit-2",className:"w-4 h-4"})}),![0,1].includes(r.is_active)&&s.jsx("button",{onClick:()=>m(Number(r.id)),className:"p-1.5 hover:bg-red-50 text-red-600 rounded-md transition-colors",children:s.jsx(i,{icon:"lucide:trash-2",className:"w-4 h-4"})})]})]})},r.id))})})]})};function v({modules_data:d,parents:l,permissions:o,existing_groups:n}){var c;const{config:v}=e().props,j=null==(c=null==v?void 0:v.theme)?void 0:c.color_primary,f="default"!==j&&j?j:"#4f46e5",[N,k]=r.useState(!0),[w,_]=r.useState(!1),[C,S]=r.useState(!1),[I,A]=r.useState(null),[M,D]=r.useState(""),[E,G]=r.useState([]),{data:P,setData:$,post:R,put:T,delete:U,processing:O,errors:L,reset:q}=a({title:"",url:"",route:"",icon:"",parent_id:"",permission_name:"",is_active:3,group:"general",by_module:"",order:0});r.useEffect(()=>{const e=setTimeout(()=>k(!1),500);return()=>clearTimeout(e)},[]);const z=(e=null,r="general",a="")=>{A(e),e?$({title:e.title,url:e.url||"",route:e.route||"",icon:e.icon||"",parent_id:e.parent_id?String(e.parent_id):"",permission_name:e.permission_name||"",is_active:e.is_active,group:e.group,by_module:e.by_module,order:e.order}):(q(),$(e=>({...e,group:r,by_module:a,is_active:3}))),_(!0)},B=e=>{confirm("Delete this menu?")&&U(route("futurisme.sidebar.destroy",e))};return N?s.jsx(g,{children:s.jsx(b,{})}):s.jsxs(g,{header:"Sidebar Management",children:[s.jsx(t,{title:"Sidebar Management"}),s.jsxs("div",{className:"flex h-[calc(100vh-4rem)] overflow-hidden bg-gray-50/50 dark:bg-gray-900",children:[s.jsx("aside",{className:"hidden lg:block w-64 h-full overflow-y-auto border-r border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 p-6",children:s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Modules"}),s.jsx("div",{className:"space-y-1",children:d.map(e=>s.jsx("button",{onClick:()=>(e=>{const r=document.getElementById(`module-${e}`);r&&r.scrollIntoView({behavior:"smooth"})})(e.module_name),className:"w-full text-left px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-indigo-50 dark:hover:bg-gray-800 hover:text-indigo-600 dark:hover:text-indigo-400 rounded-lg transition-colors truncate",children:e.module_name},e.module_name))})]})}),s.jsx("main",{className:"flex-1 h-full overflow-y-auto p-4 lg:p-8 scroll-smooth",children:s.jsxs("div",{className:"max-w-5xl mx-auto",children:[s.jsx("div",{className:"mb-8 flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white tracking-tight",children:"Sidebar Manager"}),s.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Configure application menu structure and visibility."})]})}),d.map(e=>s.jsx(y,{moduleData:e,primaryColor:f,onAddGroup:()=>S(!0),onAddItem:(e,r)=>z(null,e,r),onEditItem:e=>z(e),onDelete:B},e.module_name))]})})]}),s.jsx(h,{isOpen:w,onClose:()=>_(!1),title:I?"Edit Menu":"New Menu",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),I?T(route("futurisme.sidebar.update",I.id),{onSuccess:()=>_(!1)}):R(route("futurisme.sidebar.store"),{onSuccess:()=>_(!1)})},className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Title"}),s.jsx(u,{value:P.title,onChange:e=>$("title",e.target.value),className:"w-full mt-1",placeholder:"Menu Title"}),s.jsx(x,{message:L.title})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Icon (Iconify)"}),s.jsxs("div",{className:"relative",children:[s.jsx(u,{value:P.icon,onChange:e=>$("icon",e.target.value),className:"w-full mt-1 pl-9",placeholder:"lucide:home"}),s.jsx("div",{className:"absolute top-[2.1rem] left-3 text-gray-400",children:s.jsx(i,{icon:P.icon||"lucide:search",className:"w-4 h-4"})})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Route Name"}),s.jsx(u,{value:P.route,onChange:e=>$("route",e.target.value),className:"w-full mt-1",placeholder:"admin.dashboard"})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Direct URL"}),s.jsx(u,{value:P.url,onChange:e=>$("url",e.target.value),className:"w-full mt-1",placeholder:"/custom/path"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Group"}),s.jsxs("select",{value:P.group,onChange:e=>$("group",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n.map(e=>s.jsx("option",{value:e,children:e},e)),E.map(e=>s.jsxs("option",{value:e,children:[e," (New)"]},e))]})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Parent"}),s.jsxs("select",{value:P.parent_id,onChange:e=>$("parent_id",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[s.jsx("option",{value:"",children:"No Parent (Root)"}),l.filter(e=>e.id!==(null==I?void 0:I.id)).map(e=>s.jsx("option",{value:e.id,children:e.title},e.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(m,{value:"Permission"}),s.jsxs("select",{value:P.permission_name,onChange:e=>$("permission_name",e.target.value),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[s.jsx("option",{value:"",children:"No Permission Required"}),o.map(e=>s.jsx("option",{value:e.name,children:e.name},e.name))]})]}),s.jsxs("div",{children:[s.jsx(m,{value:"Status"}),s.jsxs("select",{value:P.is_active,onChange:e=>$("is_active",parseInt(e.target.value)),className:"w-full mt-1 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[s.jsx("option",{value:"0",children:"0 - Inactive (System Protected)"}),s.jsx("option",{value:"1",children:"1 - Active (System Protected)"}),s.jsx("option",{value:"2",children:"2 - Inactive (User)"}),s.jsx("option",{value:"3",children:"3 - Active (User)"}),s.jsx("option",{value:"4",children:"4 - Draft (User)"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100 dark:border-gray-800 mt-6",children:[s.jsx("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx(p,{disabled:O,style:{backgroundColor:f},className:"rounded-lg shadow-lg",children:I?"Update Menu":"Create Menu"})]})]})}),s.jsx(h,{isOpen:C,onClose:()=>S(!1),title:"New Group",maxWidth:"max-w-sm",children:s.jsxs("div",{children:[s.jsx(m,{value:"Group Name"}),s.jsx(u,{value:M,onChange:e=>D(e.target.value),className:"w-full mt-1",autoFocus:!0,placeholder:"e.g. Analytics"}),s.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[s.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx(p,{onClick:()=>{M.trim()&&(G([...E,M]),S(!1),D(""),q(),$(e=>({...e,group:M})),_(!0))},style:{backgroundColor:f},className:"rounded-lg shadow-lg",children:"Create Group"})]})]})})]})}export{v as default};
